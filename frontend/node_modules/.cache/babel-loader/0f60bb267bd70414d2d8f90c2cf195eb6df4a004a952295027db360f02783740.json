{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/AZIZ/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/AZIZ/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/AZIZ/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useState,useContext,useEffect}from'react';import{authAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext(null);export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];useEffect(function(){var token=localStorage.getItem('token');var savedUser=localStorage.getItem('user');if(token&&savedUser){setUser(JSON.parse(savedUser));}setLoading(false);},[]);var login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(email,motDePasse){var _yield$authAPI$login,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.login({email:email,motDePasse:motDePasse});case 2:_yield$authAPI$login=_context.sent;data=_yield$authAPI$login.data;localStorage.setItem('token',data.token);localStorage.setItem('user',JSON.stringify(data.user));setUser(data.user);return _context.abrupt(\"return\",data.user);case 8:case\"end\":return _context.stop();}},_callee);}));return function login(_x,_x2){return _ref2.apply(this,arguments);};}();var logout=function logout(){localStorage.removeItem('token');localStorage.removeItem('user');setUser(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user:user,login:login,logout:logout,loading:loading},children:children});};export var useAuth=function useAuth(){var context=useContext(AuthContext);if(!context)throw new Error('useAuth must be inside AuthProvider');return context;};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","authAPI","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","token","localStorage","getItem","savedUser","JSON","parse","login","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","email","motDePasse","_yield$authAPI$login","data","wrap","_callee$","_context","prev","next","sent","setItem","stringify","abrupt","stop","_x","_x2","apply","arguments","logout","removeItem","Provider","value","useAuth","context","Error"],"sources":["C:/Users/AZIZ/Desktop/pfa esprim/barhoum/frontend/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { authAPI } from '../services/api';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    const savedUser = localStorage.getItem('user');\r\n    if (token && savedUser) {\r\n      setUser(JSON.parse(savedUser));\r\n    }\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  const login = async (email, motDePasse) => {\r\n    const { data } = await authAPI.login({ email, motDePasse });\r\n    localStorage.setItem('token', data.token);\r\n    localStorage.setItem('user', JSON.stringify(data.user));\r\n    setUser(data.user);\r\n    return data.user;\r\n  };\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    setUser(null);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, login, logout, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) throw new Error('useAuth must be inside AuthProvider');\r\n  return context;\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}